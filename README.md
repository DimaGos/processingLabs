# Умный обработчик данных для лабораторных работ  
  
## Описание проекта  
  
**Умный обработчик данных для лабораторных работ** — это интерактивное приложение, разработанное на Python с использованием библиотеки Tkinter для создания графического интерфейса. Приложение упрощает процесс обработки лабораторных данных: загружает данные из файлов, строит графики, выполняет аппроксимацию и отображает таблицы с нужными вычислениями.  
## Реализуемый функционал:  
### 1. **Загрузка и отображение данных**:  
- **Поддерживаемые форматы файлов**: CSV, Excel, TXT.
- **Просмотр и редактирование данных** в таблице с возможностью удаления строк и столбцов, редактирования ячеек.
- **Переименование столбцов** для обеспечения корректной работы с данными.
### 2. **Построение графиков**:  
- **Выбор столбцов** для осей X и Y из загруженных данных.
- **Типы графиков**:
  - Точечный график.
  - Линейный график.
  - Гистограмма.
  - Столбчатая диаграмма.
- **Настройки графика**:
  - Логарифмирование осей.
  - Выбор цвета графика.
  - Добавление теоретических функций для сравнения с экспериментальными данными.
- **Сохранение графиков** в форматах PDF и PNG.
- Построение графиков с использованием **Matplotlib**.  
### 3. **Аппроксимация данных**:  
- **Методы аппроксимации**:
  - **Линейная аппроксимация** — подходящая для линейных зависимостей.
  - **Полиномиальная аппроксимация** — для более сложных зависимостей с возможностью выбора степени полинома.
  - **Аппроксимация Гаусса** — для данных, имеющих нормальное распределение.
  - **Аппроксимация Пуассона** — для дискретных событий с известной средней частотой.
- **Отображение коэффициентов аппроксимации** и коэффициента детерминации R².
- **Удаление выбросов**:
  - Автоматическое обнаружение выбросов методом интерквартильного размаха (IQR).
  - Ручной выбор выбросов на графике.
  - Удаление выбранных выбросов и обновление графика.
### 4. **Обработка таблиц**:  
- **Редактирование данных**:
  - Добавление и удаление строк и столбцов.
  - Редактирование значений ячеек.
  - Округление значений в выбранных столбцах.
- **Фильтрация данных** по заданному условию.
- **Применение пользовательских функций** к данным с использованием Python-кода.
- **Вычисление статистических параметров**:
  - Среднее, медиана, дисперсия, стандартное отклонение и другие.
  - Отображение результатов в отдельной таблице.
  - Сохранение статистики в файлы различных форматов.
---
## Внесённые изменения

#### Удаление аппроксимации Лагранжа

Аппроксимация Лагранжа была удалена из приложения, так как она наиболее эффективна при работе с точными зависимостями и может быть неэффективна или неточной для экспериментальных данных с шумом или выбросами.

### Добавление аппроксимаций Гаусса и Пуассона

- **Аппроксимация Гаусса**:
  - Используется для аппроксимации данных, имеющих нормальное распределение.
  - Позволяет определить параметры нормального распределения: среднее значение (μ) и стандартное отклонение (σ).
- **Аппроксимация Пуассона**:
  - Подходит для моделирования дискретных событий, происходящих с определённой средней частотой.
  - Полезна при анализе событий, происходящих случайно в фиксированный интервал времени или пространства.
### Добавление возможности построения гистограмм и столбчатых диаграмм

- **Гистограммы**:
  - Отображение распределения данных по интервалам.
  - Возможность наложения аппроксимации Пуассона на гистограмму для сравнения.
- **Столбчатые диаграммы**:
  - Визуализация категориальных данных или сравнение величин между разными группами.
## Архитектура проекта  
### Основной файл: `main.py`  
**Класс `MainApp`**:  
- Создаёт главное окно приложения.  
- Хранит загруженные данные в атрибуте `self.data`.  
- Управляет переходами между окнами (построение графиков, обработка таблиц).  
**Методы:**  
- `load_data()`: Загружает данные и отображает таблицу.  
- `open_plotter()`: Открывает окно построения графиков.  
- `open_table_handler()`: Открывает окно для работы с таблицами.  
  
### Модуль для загрузки данных: `file_loader.py`  
- Загружает файлы форматов **CSV, Excel, TXT**.  
- Отображает данные в таблице Tkinter с использованием `Treeview`.  
**Функции:**  
- `load_file_and_show_table()`: Загружает данные из выбранного файла и отображает их в таблице.  
- `show_table_window(data)`: Открывает окно с таблицей данных.  
  
### Модуль для построения графиков: `plotter.py`  
- Создаёт окно для построения графиков.  
- Пользователь выбирает столбцы для осей X и Y.  
- График отображается с точными делениями по осям и метками.  
**Класс `Plotter`:**  
- **Методы:**  
- `__init__(self, master, data)`: Инициализирует окно с графиком.  
- `create_widgets()`: Создаёт выпадающие списки для выбора столбцов.  
- `plot_graph()`: Строит график по выбранным столбцам.  
  
### Модуль для работы с таблицами: `table_handler.py`  
- Генерирует и обрабатывает таблицы с результатами.  
**Класс `TableHandler`:**  
**Методы:**  
- `__init__(self, master, data)`: Инициализирует окно обработки таблицы.  
- `calculate_statistics()`: Вычисляет основные параметры данных (сумма, среднее, дисперсия и т.д.).  
---  
## Установка и запуск

### Клонирование репозитория

```bash
git clone https://github.com/DimaGos/processingLabs.git 
cd processingLabs
```
### Установка зависимостей

Убедитесь, что у вас установлен Python 3.x.

```bash
pip install -r requirements.txt
```
### Запуск приложения

```bash
python main.py
```  
---  
## Зависимости:  
- **Python 3.x**
- **Tkinter** — для графического интерфейса (входит в стандартную библиотеку Python).
- **Matplotlib** — для построения графиков.
- **Seaborn** — для расширенных возможностей визуализации.
- **NumPy** — для числовых вычислений.
- **Pandas** — для работы с данными в таблицах.
- **SciPy** — для научных вычислений и аппроксимаций.
- **Pillow** — для работы с изображениями в интерфейсе.
- **EasyGUI** — для удобного выбора файлов пользователем.
#### Дополнительные требования
### Дополнительные требования

Для корректного отображения математических формул на графиках необходимо установить LaTeX-дистрибутив:

- **Windows**: [MiKTeX](https://miktex.org/download)
- **macOS**: [MacTeX](https://tug.org/mactex/)
- **Linux**: Установите `TeX Live` через менеджер пакетов вашей системы.

После установки LaTeX убедитесь, что он добавлен в переменную окружения PATH.

Если у вас возникают проблемы с отображением шрифтов или формул на графиках, попробуйте изменить настройки шрифтов в коде или отключить использование LaTeX в `matplotlib`.

```bash
matplotlib.rcParams['text.usetex'] = False
```
---
## Инструкция по использованию

### Загрузка данных

1. **Запустите приложение** с помощью команды `python main.py`.
2. В главном окне выберите **"Загрузить и отобразить данные"**.
3. Выберите файл с данными в одном из поддерживаемых форматов.
4. При необходимости переименуйте столбцы для корректной работы.

### Построение графиков

1. После загрузки данных выберите **"Построить график"** в главном меню.
2. В окне построения графика выберите столбцы для осей X и Y.
3. Настройте параметры графика:
   - Тип графика (точечный, линейный, гистограмма, столбчатая диаграмма).
   - Метод аппроксимации.
   - Логарифмирование осей.
   - Добавление теоретических функций.
4. Нажмите **"Построить график"**.
5. При необходимости сохраните график в PDF или PNG формате.

### Обработка таблиц

1. В главном окне выберите **"Обработать таблицу"**.
2. В окне обработки таблицы доступны следующие функции:
   - Добавление и удаление строк и столбцов.
   - Редактирование значений ячеек.
   - Округление значений.
   - Применение пользовательских функций к данным.
   - Вычисление статистических параметров.
   - Фильтрация данных по условиям.
3. Изменения могут быть сохранены в новые файлы.